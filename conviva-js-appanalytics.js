/*!
 * Browser tracker for Snowplow v0.4.8 (http://bit.ly/sp-js)
 * Copyright 2022 Snowplow Analytics Ltd, 2010 Anthon Pang
 * Licensed under BSD-3-Clause
 */

'use strict';(function(C,U){"object"===typeof exports&&"undefined"!==typeof module?U(exports):"function"===typeof define&&define.amd?define(["exports"],U):(C="undefined"!==typeof globalThis?globalThis:C||self,U(C.snowplowBrowserTracking={}))})(this,function(C){function U(a,c,d){if(d||2===arguments.length)for(var e=0,h=c.length,g;e<h;e++)!g&&e in c||(g||(g=Array.prototype.slice.call(c,0,e)),g[e]=c[e]);return a.concat(g||Array.prototype.slice.call(c))}function Qd(a){var c=0,d=0;var e="";var h=[];if(!a)return a;
a+="";do{var g=Da.indexOf(a.charAt(c++));var l=Da.indexOf(a.charAt(c++));e=Da.indexOf(a.charAt(c++));var p=Da.indexOf(a.charAt(c++));var v=g<<18|l<<12|e<<6|p;g=v>>16&255;l=v>>8&255;v&=255;64===e?h[d++]=String.fromCharCode(g):64===p?h[d++]=String.fromCharCode(g,l):h[d++]=String.fromCharCode(g,l,v)}while(c<a.length);e=h.join("");return function(r){return decodeURIComponent(r.split("").map(function(q){return"%"+("00"+q.charCodeAt(0).toString(16)).slice(-2)}).join(""))}(e.replace(/\0+$/,""))}function Bb(){var a=
{},c=[],d=[],e=[],h,g=function(l,p){null!=p&&""!==p&&(a[l]=p)};return{add:g,addDict:function(l){for(var p in l)Object.prototype.hasOwnProperty.call(l,p)&&g(p,l[p])},addJson:function(l,p,v){v&&Zc(v)&&(l={keyIfEncoded:l,keyIfNotEncoded:p,json:v},d.push(l),c.push(l))},addContextEntity:function(l){e.push(l)},getPayload:function(){return a},getJson:function(){return c},withJsonProcessor:function(l){h=l},build:function(){null===h||void 0===h?void 0:h(this,d,e);return a}}}function Rd(a){return function(c,
d,e){for(var h=function(r,q,t){r=JSON.stringify(r);if(a){t=c.add;if(r){var x=0,m=0,B=[];if(r){r=unescape(encodeURIComponent(r));do{var n=r.charCodeAt(x++);var M=r.charCodeAt(x++);var O=r.charCodeAt(x++);var P=n<<16|M<<8|O;n=P>>18&63;M=P>>12&63;O=P>>6&63;P&=63;B[m++]=Da.charAt(n)+Da.charAt(M)+Da.charAt(O)+Da.charAt(P)}while(x<r.length);x=B.join("");r=r.length%3;r=(r?x.slice(0,r-3):x)+"===".slice(r||3)}r=r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}t.call(c,q,r)}else c.add(t,r)},g=function(r,
q){if(!r){var t=c.getPayload();if(a?t.cx:t.co){r=JSON;var x=r.parse;if(a){if(t=t.cx){switch(4-t.length%4){case 2:t+="==";break;case 3:t+="="}t=t.replace(/-/g,"+").replace(/_/g,"/");t=Qd(t)}}else t=t.co;r=x.call(r,t)}else r=void 0}r?r.data=r.data.concat(q.data):r=q;return r},l=void 0,p=0;p<d.length;p++){var v=d[p];"cx"===v.keyIfEncoded?l=g(l,v.json):h(v.json,v.keyIfEncoded,v.keyIfNotEncoded)}d.length=0;e.length&&(d={schema:"iglu:com.snowplowanalytics.snowplow/contexts/jsonschema/1-0-0",data:U([],e,
!0)},l=g(l,d),e.length=0);l&&h(l,"cx","co")}}function Zc(a){if(!$c(a))return!1;for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c))return!0;return!1}function $c(a){return"undefined"!==typeof a&&null!==a&&(a.constructor==={}.constructor||a.constructor===[].constructor)}function Sd(){var a=[],c=[];return{getGlobalPrimitives:function(){return a},getConditionalProviders:function(){return c},addGlobalContexts:function(d){for(var e=[],h=[],g=0;g<d.length;g++){var l=d[g];ad(l)?e.push(l):cb(l)&&h.push(l)}a=
a.concat(h);c=c.concat(e)},clearGlobalContexts:function(){c=[];a=[]},removeGlobalContexts:function(d){for(var e=function(g){ad(g)?c=c.filter(function(l){return JSON.stringify(l)!==JSON.stringify(g)}):cb(g)&&(a=a.filter(function(l){return JSON.stringify(l)!==JSON.stringify(g)}))},h=0;h<d.length;h++)e(d[h])},getApplicableContexts:function(d){a:{var e=0;for(var h=d.getJson();e<h.length;e++){var g=h[e];if("ue_px"===g.keyIfEncoded&&"object"===typeof g.json.data&&(g=g.json.data.schema,"string"==typeof g)){e=
g;break a}}e=""}h=d.getPayload().e;g="string"===typeof h?h:"";h=[];var l=Wb(a,d,g,e);h.push.apply(h,l);d=Td(c,d,g,e);h.push.apply(h,d);return h}}}function Ud(a){return{addPluginContexts:function(c){var d=c?U([],c,!0):[];a.forEach(function(e){try{e.contexts&&d.push.apply(d,e.contexts())}catch(h){ma.error("Error adding plugin contexts",h)}});return d}}}function Vd(a){if("*"===a[0]||"*"===a[1])return!1;if(0<a.slice(2).length){var c=!1,d=0;for(a=a.slice(2);d<a.length;d++)if("*"===a[d])c=!0;else if(c)return!1;
return!0}return 2==a.length?!0:!1}function bd(a){return(a=a.split("."))&&1<a.length?Vd(a):!1}function cd(a){a=/^iglu:((?:(?:[a-zA-Z0-9-_]+|\*).)+(?:[a-zA-Z0-9-_]+|\*))\/([a-zA-Z0-9-_.]+|\*)\/jsonschema\/([1-9][0-9]*|\*)-(0|[1-9][0-9]*|\*)-(0|[1-9][0-9]*|\*)$/.exec(a);if(null!==a&&bd(a[1]))return a.slice(1,6)}function Xb(a){if(a=cd(a)){var c=a[0];return 5===a.length&&bd(c)}return!1}function Wd(a){return Array.isArray(a)&&a.every(function(c){return"string"===typeof c})}function dd(a){return Wd(a)?a.every(function(c){return Xb(c)}):
"string"===typeof a?Xb(a):!1}function nb(a){return Zc(a)&&"schema"in a&&"data"in a?"string"===typeof a.schema&&"object"===typeof a.data:!1}function Xd(a){var c=0;if(null!=a&&"object"===typeof a&&!Array.isArray(a)){if(Object.prototype.hasOwnProperty.call(a,"accept"))if(dd(a.accept))c+=1;else return!1;if(Object.prototype.hasOwnProperty.call(a,"reject"))if(dd(a.reject))c+=1;else return!1;return 0<c&&2>=c}return!1}function Cb(a){return"function"===typeof a&&1>=a.length}function cb(a){return Cb(a)||nb(a)}
function ed(a){return Array.isArray(a)&&2===a.length?Array.isArray(a[1])?Cb(a[0])&&a[1].every(cb):Cb(a[0])&&cb(a[1]):!1}function fd(a){return Array.isArray(a)&&2===a.length?Xd(a[0])?Array.isArray(a[1])?a[1].every(cb):cb(a[1]):!1:!1}function ad(a){return ed(a)||fd(a)}function Yd(a,c){var d=0,e=0,h=a.accept;Array.isArray(h)?a.accept.some(function(g){return Db(g,c)})&&e++:"string"===typeof h&&Db(h,c)&&e++;h=a.reject;Array.isArray(h)?a.reject.some(function(g){return Db(g,c)})&&d++:"string"===typeof h&&
Db(h,c)&&d++;return 0<e&&0===d?!0:!1}function Db(a,c){if(!Xb(a))return!1;a=cd(a);c=/^iglu:([a-zA-Z0-9-_.]+)\/([a-zA-Z0-9-_]+)\/jsonschema\/([1-9][0-9]*)-(0|[1-9][0-9]*)-(0|[1-9][0-9]*)$/.exec(c);c=null!==c?c.slice(1,6):void 0;if(a&&c){if(!Zd(a[0],c[0]))return!1;for(var d=1;5>d;d++)if(!gd(a[d],c[d]))return!1;return!0}return!1}function Zd(a,c){c=c.split(".");a=a.split(".");if(c&&a){if(c.length!==a.length)return!1;for(var d=0;d<a.length;d++)if(!gd(c[d],a[d]))return!1;return!0}return!1}function gd(a,
c){return a&&c&&"*"===a||a===c}function hd(a){return Array.isArray(a)?a:[a]}function Wb(a,c,d,e){var h;a=hd(a).map(function(g){a:if(nb(g))g=[g];else{if(Cb(g)){b:{var l=void 0;try{var p={event:c.getPayload(),eventType:d,eventSchema:e};l=g(p);if(Array.isArray(l)&&l.every(nb)||nb(l)){var v=l;break b}v=void 0;break b}catch(r){}v=void 0}if(nb(v)){g=[v];break a}else if(Array.isArray(v)){g=v;break a}}g=void 0}if(g&&0!==g.length)return g});return(h=[]).concat.apply(h,a.filter(function(g){return null!=g&&
g.filter(Boolean)}))}function Td(a,c,d,e){var h;a=hd(a).map(function(g){a:{if(ed(g)){var l=g[0],p=!1;try{var v={event:c.getPayload(),eventType:d,eventSchema:e};p=l(v)}catch(r){p=!1}if(!0===p){g=Wb(g[1],c,d,e);break a}}else if(fd(g)&&Yd(g[0],e)){g=Wb(g[1],c,d,e);break a}g=[]}if(g&&0!==g.length)return g});return(h=[]).concat.apply(h,a.filter(function(g){return null!=g&&g.filter(Boolean)}))}function $d(a){return null==a?{type:"dtm",value:(new Date).getTime()}:"number"===typeof a?{type:"dtm",value:a}:
"ttm"===a.type?{type:"ttm",value:a.value}:{type:"dtm",value:a.value||(new Date).getTime()}}function ae(a){void 0===a&&(a={});var c=a.base64,d=a.corePlugins,e=null!==d&&void 0!==d?d:[];c=function(g,l,p){function v(m,B){m=q.getApplicableContexts(m);var n=[];B&&B.length&&n.push.apply(n,B);m&&m.length&&n.push.apply(n,m);return n}var r=Ud(l),q=Sd(),t=g,x={};return{track:function(m,B,n){m.withJsonProcessor(Rd(t));m.add("eid",Ea.v4());m.addDict(x);n=$d(n);m.add(n.type,n.value.toString());B=v(m,r.addPluginContexts(B));
B=B&&B.length?{schema:"iglu:com.snowplowanalytics.snowplow/contexts/jsonschema/1-0-0",data:B}:void 0;void 0!==B&&m.addJson("cx","co",B);l.forEach(function(O){try{O.beforeTrack&&O.beforeTrack(m)}catch(P){ma.error("Plugin beforeTrack",P)}});"function"===typeof p&&p(m);var M=m.build();l.forEach(function(O){try{O.afterTrack&&O.afterTrack(M)}catch(P){ma.error("Plugin afterTrack",P)}});return M},addPayloadPair:function(m,B){x[m]=B},configuration:a,getConfig:function(){return a},setConfig:function(m){m&&
("undefined"!==typeof m.base64&&(t=a.base64=m.base64),"undefined"!==typeof m.linkClickTracking&&(a.linkClickTracking=m.linkClickTracking),"undefined"!==typeof m.cacheRefreshInterval&&(a.cacheRefreshInterval=m.cacheRefreshInterval),"undefined"!==typeof m.buttonClickTracking&&(a.buttonClickTracking=m.buttonClickTracking),"undefined"!==typeof m.customEvent&&(a.customEvent=m.customEvent),"undefined"!==typeof m.exceptionAutotracking&&(a.exceptionAutotracking=m.exceptionAutotracking),"undefined"!==typeof m.enablePeriodicHeartbeat&&
(a.enablePeriodicHeartbeat=m.enablePeriodicHeartbeat),"undefined"!==typeof m.periodicHeartbeatInterval&&(a.periodicHeartbeatInterval=m.periodicHeartbeatInterval),"undefined"!==typeof m.customEventTrackingConfiguration&&(a.customEventTrackingConfiguration=m.customEventTrackingConfiguration),"undefined"!==typeof m.convivaVideoEventTrackingConfiguration&&(a.convivaVideoEventTrackingConfiguration=m.convivaVideoEventTrackingConfiguration),"undefined"!==typeof m.ajaxTrackingConfiguration&&(a.ajaxTrackingConfiguration=
m.ajaxTrackingConfiguration),"undefined"!==typeof m.networkRequestTrackingConfiguration&&(a.networkRequestTrackingConfiguration=m.networkRequestTrackingConfiguration),"undefined"!==typeof m.metaTagsTrackingConfiguration&&(a.metaTagsTrackingConfiguration=m.metaTagsTrackingConfiguration))},getBase64Encoding:function(){return t},setBase64Encoding:function(m){t=m},addPayloadDict:function(m){for(var B in m)Object.prototype.hasOwnProperty.call(m,B)&&(x[B]=m[B])},resetPayloadPairs:function(m){x=$c(m)?m:
{}},setTrackerVersion:function(m){x.tv=m},setTrackerNamespace:function(m){x.tna=m},setAppId:function(m){x.aid=m},setPlatform:function(m){x.p=m},setUserId:function(m){x.uid=m},setScreenResolution:function(m,B){x.res=m+"x"+B},setViewport:function(m,B){x.vp=m+"x"+B},setColorDepth:function(m){x.cd=m},setTimezone:function(m){x.tz=m},setLang:function(m){x.lang=m},setIpAddress:function(m){x.ip=m},setUseragent:function(m){x.ua=m},addGlobalContexts:function(m){q.addGlobalContexts(m)},clearGlobalContexts:function(){q.clearGlobalContexts()},
removeGlobalContexts:function(m){q.removeGlobalContexts(m)}}}(null!==c&&void 0!==c?c:!0,e,a.callback);var h=X(X({},c),{addPlugin:function(g){var l,p;g=g.plugin;e.push(g);null===(l=g.logger)||void 0===l?void 0:l.call(g,ma);null===(p=g.activateCorePlugin)||void 0===p?void 0:p.call(g,h)}});null===e||void 0===e?void 0:e.forEach(function(g){var l,p;null===(l=g.logger)||void 0===l?void 0:l.call(g,ma);null===(p=g.activateCorePlugin)||void 0===p?void 0:p.call(g,h)});return h}function ob(a){var c=a.event;
a=c.schema;var d=c.data;c=Bb();a={schema:"iglu:com.snowplowanalytics.snowplow/unstruct_event/jsonschema/1-0-0",data:{schema:a,data:d}};c.add("e","ue");c.addJson("ue_px","ue_pr",a);return c}function be(a){var c=a.pageUrl,d=a.pageTitle;a=a.referrer;var e=Bb();e.add("e","pv");e.add("url",c);e.add("page",d);e.add("refr",a);return e}function Yb(a){return ob({event:{schema:"iglu:com.conviva/raw_event/jsonschema/1-0-1",data:Eb({name:a.name,data:a.data})}})}function ce(a){return ob({event:{schema:"iglu:com.conviva/network_request/jsonschema/1-0-4",
data:Eb({targetUrl:a.targetUrl,method:a.method,queryParameters:a.queryParameters,responseStatusCode:a.responseStatusCode,responseStatusText:a.responseStatusText,rqh:a.rqh,rsh:a.rsh,rqb:a.rqb,rsb:a.rsb,requestSize:a.requestSize,responseSize:a.responseSize,duration:a.duration,contentType:a.contentType,requestTimestamp:a.requestTimestamp,responseTimestamp:a.responseTimestamp})}})}function Zb(a){return ob({event:{schema:"iglu:com.conviva/conviva_video_events/jsonschema/1-0-5",data:Eb({name:a.name,sid:a.sid,
iid:a.iid,clid:a.clid,st:a.st,cen:a.cen,ced:a.ced})}})}function Eb(a,c){void 0===c&&(c={});var d={},e;for(e in a)if(c[e]||null!==a[e]&&"undefined"!==typeof a[e])d[e]=a[e];return d}function id(a){return Number.isInteger&&Number.isInteger(a)||"number"===typeof a&&isFinite(a)&&Math.floor(a)===a}function $b(a){if(!a||"string"!==typeof a.valueOf()){a=a.text||"";var c=document.getElementsByTagName("title");c&&null!=c[0]&&(a=c[0].text)}return a}function ac(a){var c=/^(?:(?:https?|ftp):)\/*(?:[^@]+@)?([^:/#]+)/.exec(a);
return c?c[1]:a}function jd(a){var c=a.length;"."===a.charAt(--c)&&(a=a.slice(0,c));"*."===a.slice(0,2)&&(a=a.slice(1));return a}function bc(a){var c=window,d=pb("referrer",c.location.href)||pb("referer",c.location.href);if(d)return d;if(a)return a;try{if(c.top)return c.top.document.referrer;if(c.parent)return c.parent.document.referrer}catch(e){}return document.referrer}function Fa(a,c,d,e){if(a.addEventListener)return a.addEventListener(c,d,e),!0;if(a.attachEvent)return a.attachEvent("on"+c,d);
a["on"+c]=d}function pb(a,c){return(a=(new RegExp("^[^#]*[?&]"+a+"=([^&#]*)")).exec(c))?decodeURIComponent(a[1].replace(/\+/g," ")):null}function Fb(a,c,d){void 0===d&&(d=63072E3);try{var e=window.localStorage,h=Date.now()+1E3*d;e.setItem("".concat(a,".expires"),h.toString());e.setItem(a,c);return!0}catch(g){return!1}}function kd(a){try{var c=window.localStorage;c.removeItem(a);c.removeItem(a+".expires");return!0}catch(d){return!1}}function de(a,c){for(var d=window.location.hostname,e="_sp_root_domain_test_"+
(new Date).getTime(),h="_test_value_"+(new Date).getTime(),g=d.split("."),l=g.length-1;0<=l;){var p=g.slice(l,g.length).join(".");qa(e,h,0,"/",p,a,c);if(qa(e)===h){qa(e,"",-1,"/",p,a,c);d=document.cookie.split("; ");e=[];for(h=0;h<d.length;h++)"_sp_root_domain_test_"===d[h].substring(0,21)&&e.push(d[h]);d=e;for(e=0;e<d.length;e++)qa(d[e],"",-1,"/",p,a,c);return p}--l}return d}function qa(a,c,d,e,h,g,l){return 1<arguments.length?document.cookie=a+"="+encodeURIComponent(null!==c&&void 0!==c?c:"")+(d?
"; Expires="+(new Date(+new Date+1E3*d)).toUTCString():"")+(e?"; Path="+e:"")+(h?"; Domain="+h:"")+(g?"; SameSite="+g:"")+(l?"; Secure":""):decodeURIComponent((("; "+document.cookie).split("; "+a+"=")[1]||"").split(";")[0])}function ee(a,c){var d=[ha.request_body,ha.response_body,ha.request_headers,ha.response_headers],e={};if(c&&0<c.length)for(var h=0;h<c.length;h++){var g=c[h],l=g.conditions;var p=void 0;var v=["conditions"],r={};for(p in g)Object.prototype.hasOwnProperty.call(g,p)&&0>v.indexOf(p)&&
(r[p]=g[p]);if(null!=g&&"function"===typeof Object.getOwnPropertySymbols){var q=0;for(p=Object.getOwnPropertySymbols(g);q<p.length;q++)0>v.indexOf(p[q])&&Object.prototype.propertyIsEnumerable.call(g,p[q])&&(r[p[q]]=g[p[q]])}p=r;try{a:{g=a;try{for(v=0;v<l.length;v++){var t=l[v];r=!1;if(0<Object.keys(t).length){q=0;for(var x=Object.entries(t);q<x.length;q++){var m=x[q],B=m[1],n=g[m[0]];if(0<B.length){for(var M=0,O=0,P=B;O<P.length;O++){var G=P[O],ba="contains",ka=G;if("object"===typeof G&&G.length)ba=
G[1],ka=G[0];else if("boolean"===typeof G||null===G)ba="equal",ka=G;if(fe(n,ba,ka)){r=!0;break}else if(r=!1,M+1===B.length)break;M++}if(!1===r)break}}}if(r){var xa=!0;break a}}}catch(da){console.warn("Conviva App Tracker: Error in Applying nwreqConfig ".concat(da))}xa=!1}if(xa){g=0;for(var ra=Object.entries(a);g<ra.length;g++){var ea=ra[g],S=ea[0],K=ea[1];if(d.includes(S))try{if(p[S]&&0<p[S].length){v=!1;if(S===ha.response_headers||S===ha.request_headers)v=!0;var na=a[S];l={};try{r=0;for(var Ga=p[S];r<
Ga.length;r++){var oa=Ga[r];q=na;M=l;v&&(oa=oa.toLowerCase());var pa=oa.split(".");for(O=0;O<pa.length;O++){var ja=pa[O];"undefined"!==typeof q&&null!==q&&q.hasOwnProperty(ja)&&(O===pa.length-1?M[ja]=q[ja]:(M[ja]=M[ja]||{},q=q[ja],M=M[ja]))}}}catch(da){console.warn("Conviva App Tracker: Error in filtering schema object nwreq ".concat(da))}var sa=l;0!==Object.keys(sa).length&&(e[S]=sa)}}catch(da){e[S]=void 0}else e[S]=K}return e}}catch(da){console.warn("Conviva App Tracker: Error in collecting attributes nwreqConfig ".concat(da))}}e=
X({},a);for(a=0;a<d.length;a++)c=d[a],"undefined"!==typeof e&&null!==e&&e.hasOwnProperty(c)&&delete e[c];return e}function fe(a,c,d){try{if("string"===typeof d&&"string"===typeof a&&"*"===d.trim())return!0;switch(c){case "==":case "equal":return a===d;case "!=":return a!==d;case ">":return a>d;case "<":return a<d;case ">=":return a>=d;case "<=":return a<=d;case "contains":return""!==d&&"string"===typeof a&&"string"===typeof d&&-1!==a.toLowerCase().indexOf(d.toLowerCase());default:return!1}}catch(e){return console.warn("Conviva App Tracker: Error in Compare values nwreq ".concat(e)),
!1}}function ge(){try{var a=!!window.localStorage}catch(d){a=!0}if(!a)return!1;try{var c=window.localStorage;c.setItem("modernizr","modernizr");c.removeItem("modernizr");return!0}catch(d){return!1}}function he(a,c,d,e,h,g,l,p,v,r,q,t,x,m,B,n){function M(w){var H=Object.keys(w).map(function(F){return[F,w[F]]}).reduce(function(F,A){F[A[0]]=A[1].toString();return F},{});return{evt:H,bytes:O(JSON.stringify(H))}}function O(w){for(var H=0,F=0;F<w.length;F++){var A=w.charCodeAt(F);127>=A?H+=1:2047>=A?H+=
2:55296<=A&&57343>=A?(H+=4,F++):H=65535>A?H+3:H+4}return H}function P(w){for(void 0===w&&(w=!1);K.length&&"string"!==typeof K[0]&&"object"!==typeof K[0];)K.shift();if(1>K.length)ea=!1;else{if(!S||"string"!==typeof S.valueOf())throw"No collector configured";ea=!0;if(oa){var H=function(ca){for(var ya=0,Gb=0;ya<ca.length&&!(Gb+=ca[ya].bytes,Gb>=l);)ya+=1;return ya},F=void 0;if(db(K)){F=S;var A=G(F,!0,w);var T=H(K)}else F=xa(K[0]),A=G(F,!1,w),T=1;var Z=setTimeout(function(){A.abort();ea=!1},q),ta=function(ca){for(var ya=
0;ya<ca;ya++)K.shift();d&&Fb(sa,JSON.stringify(K.slice(0,r)))};A.onreadystatechange=function(){if(4===A.readyState&&200<=A.status)if(clearTimeout(Z),300>A.status)ta(T),P();else{var ca=A.status;ca=200<=ca&&300>ca?!1:B.includes(ca)?!0:!n.includes(ca);ca||(ma.error("Status ".concat(A.status,", will not retry.")),ta(T));ea=!1}};if(db(K)){if(H=K.slice(0,T),0<H.length){w=!1;H=H.map(function(ca){return ca.evt});if(Ga){var cc=new Blob([ba(ka(H))],{type:"application/json"});try{w=navigator.sendBeacon(F,cc)}catch(ca){w=
!1}}!0===w?(ta(T),P()):A.send(ba(ka(H)))}}else A.send()}else if(t||db(K))ea=!1;else{F=new Image(1,1);var Ha=!0;F.onload=function(){Ha&&(Ha=!1,K.shift(),d&&Fb(sa,JSON.stringify(K.slice(0,r))),P())};F.onerror=function(){Ha&&(ea=Ha=!1)};F.src=xa(K[0]);setTimeout(function(){Ha&&ea&&(Ha=!1,P())},q)}}}function G(w,H,F){var A=new XMLHttpRequest;H?(A.open("POST",w,!F),A.setRequestHeader("Content-Type","application/json; charset=UTF-8")):A.open("GET",w,!F);A.withCredentials=m;t&&A.setRequestHeader("SP-Anonymous",
"*");for(var T in x)Object.prototype.hasOwnProperty.call(x,T)&&A.setRequestHeader(T,x[T]);return A}function ba(w){return JSON.stringify({schema:"iglu:com.snowplowanalytics.snowplow/payload_data/jsonschema/1-0-4",data:w})}function ka(w){for(var H=(new Date).getTime().toString(),F=0;F<w.length;F++)w[F].stm=H;return w}function xa(w){return v?S+w.replace("?","?stm="+(new Date).getTime()+"&"):S+w}function ra(w){function H(A,T,Z){return(Z=Z.match("(Macintosh;.*Mac OS X (d+)_(d+)[_d]*.*) AppleWebKit/"))&&
Z.length?parseInt(Z[0])<=A||parseInt(Z[0])===A&&parseInt(Z[1])<=T:!1}function F(A){return A.match("Version/.* Safari/")&&!A.match("Chrom(e|ium)")}return function(A,T){return(T=T.match("(iP.+; CPU .*OS (d+)[_d]*.*) AppleWebKit/"))&&T.length?parseInt(T[0])<=A:!1}(13,w)||H(10,15,w)&&F(w)}var ea=!1,S,K=[];e="string"===typeof e?e.toLowerCase():e;var na=!0===e||"beacon"===e||"true"===e,Ga=!(!(na&&window.navigator&&window.navigator.sendBeacon)||ra(window.navigator.userAgent))&&na,oa=!!(window.XMLHttpRequest&&
"withCredentials"in new XMLHttpRequest),pa="get"!==e&&oa&&("post"===e||na),ja=pa?h:"/i",sa="snowplowOutQueue_".concat(a,"_").concat(pa?"post2":"get");na&&(x={});g=d&&ge()&&pa&&g||1;if(d)try{var da=window.localStorage.getItem(sa);K=da?JSON.parse(da):[]}catch(w){}Array.isArray(K)||(K=[]);c.outQueues.push(K);oa&&1<g&&c.bufferFlushers.push(function(w){ea||P(w)});var db=function(w){return"object"===typeof w[0]};return{enqueueRequest:function(w,H){S=H+ja;if(pa){w=M(w);if(w.bytes>=l){ma.warn("Event ("+w.bytes+
"B) too big, max is "+l);H=w;G(S,!0,!1).send(ba(ka([H.evt])));return}K.push(w)}else{var F="?";var A={co:!0,cx:!0},T=!0,Z;for(Z in w)w.hasOwnProperty(Z)&&!A.hasOwnProperty(Z)&&(T?T=!1:F+="&",F+=encodeURIComponent(Z)+"="+encodeURIComponent(w[Z]));for(var ta in A)w.hasOwnProperty(ta)&&A.hasOwnProperty(ta)&&(F+="&"+ta+"="+encodeURIComponent(w[ta]));if(0<p&&(A=xa(F),A=O(A),A>=p)){ma.warn("Event ("+A+"B) too big, max is "+p);oa&&(w=M(w),G(H+h,!0,!1).send(ba(ka([w.evt]))));return}K.push(F)}H=!1;d&&(H=Fb(sa,
JSON.stringify(K.slice(0,r))));ea||H&&!(K.length>=g)||P()},executeQueue:function(){ea||P()},setUseLocalStorage:function(w){d=w},setAnonymousTracking:function(w){t=w},setCollectorUrl:function(w){S=w+ja},setBufferSize:function(w){g=w},setCustomHeaders:function(w){x=w}}}function ld(a,c,d){if("translate.googleusercontent.com"===a)""===d&&(d=c),a=(a=/^(?:https?|ftp)(?::\/*(?:[^?]+))([?][^#]+)/.exec(c))&&1<(null===a||void 0===a?void 0:a.length)?pb("u",a[1]):null,c=null!==a&&void 0!==a?a:"",a=ac(c);else if("cc.bingj.com"===
a||"webcache.googleusercontent.com"===a)c=document.links[0].href,a=ac(c);return[a,c,d]}function ie(a,c,d,e){var h=Math.round((new Date).getTime()/1E3);a?(a=a.split("."),a.unshift("0")):a=["1",c,h,e,h,"",d];a[6]&&"undefined"!==a[6]||(a[6]=Ea.v4());a[7]&&"undefined"!==a[7]||(a[7]="");a[8]&&"undefined"!==a[8]||(a[8]="");a[9]&&"undefined"!==a[9]||(a[9]="");a[10]&&"undefined"!==a[10]||(a[10]=-1);var g=function(l,p){l=parseInt(l);return isNaN(l)?p:l};c=function(l){return l?g(l,void 0):void 0};return[a[0],
a[1],g(a[2],h),g(a[3],e),g(a[4],h),c(a[5]),a[6],a[7],a[8],c(a[9]),g(a[10],-1)]}function qb(a,c){void 0===c&&(c=1);"0"===a[0]?(a[7]=a[6],a[5]=a[4],a[3]++):a[3]=c;c=Ea.v4();a[6]=c;a[10]=-1;a[8]="";a[9]=void 0;return c}function dc(a){a[4]=Math.round((new Date).getTime()/1E3)}function je(a,c,d,e,h,g){function l(q,t){var x="cws.conviva.com wsg ctp remote_config .m3u8 .mpd .ism .m4 .mp4 .ts .png .jpg .jpeg .bmp google-analytics.com googlesyndication.com googleapis stats.g.doubleclick chartbeat.com omtrdc.net app-measurement.com firebase nr-data.net newrelic bitmovin.com/impression bitmovin.com/analytics api.segment.io youbora hotjar mixpanel.com clevertap auryc".split(" ");
t=JSON.parse(JSON.stringify(t));"undefined"!=typeof q.cacheRefreshInterval&&(t.cacheRefreshInterval=q.cacheRefreshInterval);"undefined"!=typeof q.configurationBundle[0].trackerConfiguration.base64Encoding&&(t.base64=q.configurationBundle[0].trackerConfiguration.base64Encoding);"undefined"!=typeof q.configurationBundle[0].trackerConfiguration.linkClickTracking&&(t.linkClickTracking=q.configurationBundle[0].trackerConfiguration.linkClickTracking);"undefined"!=typeof q.configurationBundle[0].trackerConfiguration.buttonClickTracking&&
(t.buttonClickTracking=q.configurationBundle[0].trackerConfiguration.buttonClickTracking);"undefined"!=typeof q.configurationBundle[0].trackerConfiguration.customEvent&&(t.customEvent=q.configurationBundle[0].trackerConfiguration.customEvent);"undefined"!=typeof q.configurationBundle[0].trackerConfiguration.exceptionAutotracking&&(t.exceptionAutotracking=q.configurationBundle[0].trackerConfiguration.exceptionAutotracking);"undefined"!=typeof q.configurationBundle[0].trackerConfiguration.enablePeriodicHeartbeat&&
(t.enablePeriodicHeartbeat=q.configurationBundle[0].trackerConfiguration.enablePeriodicHeartbeat);"undefined"!=typeof q.configurationBundle[0].trackerConfiguration.periodicHeartbeatInterval&&(t.periodicHeartbeatInterval=q.configurationBundle[0].trackerConfiguration.periodicHeartbeatInterval);"undefined"!=typeof q.configurationBundle[0].customEventTrackingConfiguration&&(t.customEventTrackingConfiguration=q.configurationBundle[0].customEventTrackingConfiguration);"undefined"!=typeof q.configurationBundle[0].convivaVideoEventTrackingConfiguration&&
(t.convivaVideoEventTrackingConfiguration=q.configurationBundle[0].convivaVideoEventTrackingConfiguration);"undefined"!=typeof q.configurationBundle[0].ajaxTrackingConfiguration&&(t.ajaxTrackingConfiguration=q.configurationBundle[0].ajaxTrackingConfiguration);"undefined"!=typeof q.configurationBundle[0].networkRequestTrackingConfiguration&&(t.networkRequestTrackingConfiguration=q.configurationBundle[0].networkRequestTrackingConfiguration);t.ajaxTrackingConfiguration&&(t.ajaxTrackingConfiguration.blocklist||
(t.ajaxTrackingConfiguration.blocklist=[]),t.ajaxTrackingConfiguration.blocklist.push(q.configurationBundle[0].networkConfiguration.endpoint),t.ajaxTrackingConfiguration.blocklist=t.ajaxTrackingConfiguration.blocklist.concat(x));t.networkRequestTrackingConfiguration&&(t.networkRequestTrackingConfiguration.blocklist||(t.networkRequestTrackingConfiguration.blocklist=[]),t.networkRequestTrackingConfiguration.blocklist.push(q.configurationBundle[0].networkConfiguration.endpoint),t.networkRequestTrackingConfiguration.blocklist=
t.networkRequestTrackingConfiguration.blocklist.concat(x));"undefined"!=typeof q.configurationBundle[0].metaTagsTrackingConfiguration&&(t.metaTagsTrackingConfiguration=q.configurationBundle[0].metaTagsTrackingConfiguration);r.setCollectorUrl(q.configurationBundle[0].networkConfiguration.endpoint);window.localStorage&&(localStorage.removeItem("ConvivaRemoteConfig"),localStorage.removeItem("ConvivaEndpoint"),localStorage.setItem("ConvivaRemoteConfig",JSON.stringify(t)),localStorage.setItem("ConvivaEndpoint",
q.configurationBundle[0].networkConfiguration.endpoint));r.core.setConfig(t)}function p(q,t){return U(U([],q,!0),t,!0).reduce(function(x,m){var B=x.find(function(n){return n.key===m.key});B?m.condition&&(B.condition=U(U([],B.condition||[],!0),m.condition,!0)):x.push(X({},m));return x},[])}void 0===g&&(g={});var v=[];a=function(q,t,x,m,B,n){function M(){Ma=ld(window.location.hostname,window.location.href,bc());Ma[1]!==Ia&&(rb=bc(Ia));md=jd(Ma[0]);Ia=Ma[1]}function O(b){try{var f=(new Date).getTime(),
k=b.currentTarget;if(null===k||void 0===k?0:k.href){b="_sp="+(Hb+"."+f);var u=k.href.split("#"),y=u[0].split("?"),E=y.shift(),z=y.join("?");if(z){y=!0;var L=z.split("&");for(f=0;f<L.length;f++)if("_sp="===L[f].substr(0,4)){y=!1;L[f]=b;z=L.join("&");break}y&&(z=b+"&"+z)}else z=b;u[0]=E+"?"+z;var D=u.join("#");k.href=D}}catch(Q){console.warn("Conviva App Tracker:: Error in linkDecorationHandler of decorateLinks ".concat(Q))}}function P(b){for(var f=0;f<document.links.length;f++){var k=document.links[f];
!k.spDecorationEnabled&&b(k)&&(Fa(k,"click",O,!0),Fa(k,"mousedown",O,!0),k.spDecorationEnabled=!0)}}function G(b){if(nd){var f=/#.*/;b=b.replace(f,"")}od&&(f=/[{}]/g,b=b.replace(f,""));return b}function ba(b){return(b=/^([a-z]+):/.exec(b))?b[1]:null}function ka(b){b=eb+b+"."+Na;if("localStorage"==V){try{var f=window.localStorage,k=f.getItem(b+".expires");if(null===k||+k>Date.now())var u=f.getItem(b);else f.removeItem(b),f.removeItem(b+".expires"),u=void 0}catch(y){u=void 0}return u}if("cookie"==V||
"cookieAndLocalStorage"==V)return qa(b)}function xa(){M();Na=ke((sb||md)+(ec||"/")).slice(0,4)}function ra(){fc=(new Date).getTime()}function ea(){var b=S(),f=b[0];f<Ib?Ib=f:f>Jb&&(Jb=f);b=b[1];b<Kb?Kb=b:b>Lb&&(Lb=b);ra()}function S(){var b=document.documentElement;return b?[b.scrollLeft||window.pageXOffset,b.scrollTop||window.pageYOffset]:[0,0]}function K(){var b=S(),f=b[0];Jb=Ib=f;Lb=Kb=b=b[1]}function na(){oa(eb+"ses."+Na,"*",pd)}function Ga(b){var f=eb+"id."+Na;b.shift();b=b.join(".");oa(f,b,
qd)}function oa(b,f,k){if(!fb||tb)"localStorage"==V?Fb(b,f,k):("cookie"==V||"cookieAndLocalStorage"==V)&&qa(b,f,k,ec,sb,Mb,Nb)}function pa(b){var f=eb+"id."+Na,k=eb+"ses."+Na;kd(f);kd(k);qa(f,"",-1,"/",sb,Mb,Nb);qa(k,"",-1,"/",sb,Mb,Nb);null!==b&&void 0!==b&&b.preserveSession||(Oa=Ea.v4(),ua=1);null!==b&&void 0!==b&&b.preserveUser||(Hb=Ea.v4(),Pa=null)}function ja(b){b&&b.stateStorageStrategy&&(n.stateStorageStrategy=b.stateStorageStrategy,V=rd(n));fb=!!n.anonymousTracking;tb=sd(n);gc=td(n);za.setUseLocalStorage("localStorage"==
V||"cookieAndLocalStorage"==V);za.setAnonymousTracking(gc)}function sa(){try{var b=window.localStorage.getItem(hc+"."+ic),f=JSON.parse(b||"{}");"{}"===f||"undefined"===typeof f?(ub=T(),Ob=Z(),Ja=-1):(ub=f.clId||T(),Ja=f[vb]&&2147483648>f[vb]?f[vb]:-1,Ob=Z());A()}catch(u){console.warn(u)}if(!fb||tb){b="none"!=V&&!!ka("ses");f=da();if(f[1])var k=f[1];else k=fb?"":Ea.v4(),f[1]=k;Hb=k;Oa=b?f[6]:qb(f);ua=f[3];"none"!=V&&(na(),dc(f),Ga(f))}}function da(){if("none"==V)return["1","",0,0,0,void 0,"","","",
void 0,0];var b=ka("id")||void 0;return ie(b,Hb,Oa,ua)}function db(b){return 0===b.indexOf("http")?b:("https:"===document.location.protocol?"https":"http")+"://"+b}function w(){ud&&null!=B.pageViewId||(B.pageViewId=Ea.v4())}function H(){null==B.pageViewId&&(B.pageViewId=Ea.v4());return B.pageViewId}function F(){return{contexts:function(){return[{schema:"iglu:com.snowplowanalytics.snowplow/web_page/jsonschema/1-0-0",data:{id:H()}}]}}}function A(){try{var b=window.localStorage,f={clId:ub,iid:Ob,eventIndex:Ja},
k=null;try{k=JSON.stringify(f)}catch(u){return}return b.setItem(hc+"."+ic,k)}catch(u){}}function T(){try{return Math.floor(2147483647*Math.random()).toString()+"."+Math.floor(2147483647*Math.random()).toString()+"."+Math.floor(2147483647*Math.random()).toString()+"."+Math.floor(2147483647*Math.random()).toString()}catch(b){console.warn(b)}}function Z(){try{return Math.floor(2147483647*Math.random())}catch(b){return console.warn(b),-1}}function ta(b){try{var f=Object.keys(b);vd(JSON.stringify(b))?
f.forEach(function(k){""!==k&&Object.defineProperty(jc,k,{value:""+b[k],writable:!0,enumerable:!0,configurable:!0})}):console.warn("Conviva AppTracker:: Invalid JSON Format: Error Message=")}catch(k){console.warn("Conviva AppTracker:: Invalid JSON Format: Error Message=",k)}}function cc(b){try{b.forEach(function(f){delete jc[f]})}catch(f){console.warn("Conviva AppTracker:: Failed to unset Custom tag(s). Check format of keys set.")}}function Ha(b){try{var f=Object.keys(b);vd(JSON.stringify(b))?f.forEach(function(k){""!==
k&&Object.defineProperty(kc,k,{value:""+b[k],writable:!0,enumerable:!0,configurable:!0})}):console.warn("Conviva AppTracker:: Invalid JSON Format: Error Message=")}catch(k){console.warn("Conviva AppTracker:: Invalid JSON Format: Error Message=",k)}}function ca(b){var f=b.title,k=b.context,u=b.timestamp;b=b.contextCallback;M();wd&&w();wd=!0;Ka=document.title;gb=f;f=$b(gb||Ka);hb.track(be({pageUrl:G(ib||Ia),pageTitle:f,referrer:G(Pb||rb)}),(k||[]).concat(b?b():[]),u);u=new Date;f=!1;if(la.enabled&&
!la.installed){f=la.installed=!0;var y={update:function(){if("undefined"!==typeof window&&"function"===typeof window.addEventListener){var z=!1,L=Object.defineProperty({},"passive",{get:function(){z=!0},set:function(){}}),D=function(){};window.addEventListener("testPassiveEventSupport",D,L);window.removeEventListener("testPassiveEventSupport",D,L);y.hasSupport=z}}};y.update();var E="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";Object.prototype.hasOwnProperty.call(y,
"hasSupport")?Fa(document,E,ra,{passive:!0}):Fa(document,E,ra);K();E=function(z,L){void 0===L&&(L=ra);return function(D){return Fa(document,D,L)}};"click mouseup mousedown mousemove keypress keydown keyup".split(" ").forEach(E(document));["resize","focus","blur"].forEach(E(window));E(window,ea)("scroll")}if(la.enabled&&(le||f))for(u in fc=u.getTime(),u=void 0,la.configurations)if(f=la.configurations[u])window.clearInterval(f.activityInterval),Gb(f,k,b)}function ya(){var b,f,k,u,y,E,z,L,D,Q,Y,Qa,Ra,
Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,ab,wb,bb;try{var J=r.core.getConfig(),ia=void 0;kc={};var yb=xb.MERGE;"undefined"!==typeof(null===(f=null===(b=null===n||void 0===n?void 0:n.configs)||void 0===b?void 0:b.metaTagsTracking)||void 0===f?void 0:f.preference)?yb=null===(u=null===(k=null===n||void 0===n?void 0:n.configs)||void 0===k?void 0:k.metaTagsTracking)||void 0===u?void 0:u.preference:"undefined"!==typeof(null===(y=null===J||void 0===J?void 0:J.metaTagsTrackingConfiguration)||void 0===y?void 0:y.pref)&&
(yb=null===(E=null===J||void 0===J?void 0:J.metaTagsTrackingConfiguration)||void 0===E?void 0:E.pref);switch(yb){case xb.APP:if(!1===(null===(L=null===(z=null===n||void 0===n?void 0:n.configs)||void 0===z?void 0:z.metaTagsTracking)||void 0===L?void 0:L.enabled))return;0<(null===(Y=null===(Q=null===(D=null===n||void 0===n?void 0:n.configs)||void 0===D?void 0:D.metaTagsTracking)||void 0===Q?void 0:Q.tags)||void 0===Y?void 0:Y.length)&&(ia=U([],null===(Ra=null===(Qa=null===n||void 0===n?void 0:n.configs)||
void 0===Qa?void 0:Qa.metaTagsTracking)||void 0===Ra?void 0:Ra.tags,!0));break;case xb.REMOTE:if(!1===(null===(Sa=null===J||void 0===J?void 0:J.metaTagsTrackingConfiguration)||void 0===Sa?void 0:Sa.enabled))return;"undefined"!=typeof(null===J||void 0===J?void 0:J.metaTagsTrackingConfiguration)&&0<(null===(Ua=null===(Ta=null===J||void 0===J?void 0:J.metaTagsTrackingConfiguration)||void 0===Ta?void 0:Ta.tags)||void 0===Ua?void 0:Ua.length)&&(ia=U([],null===(Va=null===J||void 0===J?void 0:J.metaTagsTrackingConfiguration)||
void 0===Va?void 0:Va.tags,!0));break;default:if("undefined"==typeof(null===J||void 0===J?void 0:J.metaTagsTrackingConfiguration)&&!1===(null===(Xa=null===(Wa=null===n||void 0===n?void 0:n.configs)||void 0===Wa?void 0:Wa.metaTagsTracking)||void 0===Xa?void 0:Xa.enabled)||!1===(null===(Ya=null===J||void 0===J?void 0:J.metaTagsTrackingConfiguration)||void 0===Ya?void 0:Ya.enabled))return;ia=U([],p((null===($a=null===(Za=null===n||void 0===n?void 0:n.configs)||void 0===Za?void 0:Za.metaTagsTracking)||
void 0===$a?void 0:$a.tags)||[],(null===(ab=null===J||void 0===J?void 0:J.metaTagsTrackingConfiguration)||void 0===ab?void 0:ab.tags)||[]),!0)}if(0<(null===ia||void 0===ia?void 0:ia.length)){b={};var jb=document.head.getElementsByTagName("meta");for(f=0;f<jb.length;f++){var va=jb[f];for(k=0;k<ia.length;k++){var wa=va.getAttribute(ia[k].key),Aa=va.getAttribute(ia[k].value);u=void 0;if(null===(wb=ia[k])||void 0===wb?0:wb.condition)u=null===(bb=ia[k])||void 0===bb?void 0:bb.condition;wa&&(u&&u.includes(wa)?
b[wa]=Aa:u&&0!==u.length||(b[wa]=Aa))}}r.setMetaCustomTags(b)}}catch(kb){console.warn("Conviva App Tracker:: setPageMetaTagsAsCustomTags",kb)}}function Gb(b,f,k){var u=function(z,L){M();var D=r.core.getConfig();D.enablePeriodicHeartbeat?void 0!=D.periodicHeartbeatInterval&&(D=1E3*D.periodicHeartbeatInterval,D!=b.configHeartBeatTimer&&(window.clearInterval(b.activityInterval),b.activityInterval=window.setInterval(E,D))):window.clearInterval(b.activityInterval);z({context:L,pageViewId:H(),minXOffset:Ib,
minYOffset:Kb,maxXOffset:Jb,maxYOffset:Lb});K()},y=new Date;window.setTimeout(function(){u(b.callback,(f||[]).concat(k?k():[]))},2E3);var E=function(){var z=new Date;if(y.getTime()+b.configHeartBeatTimer>z.getTime()||fc+b.configHeartBeatTimer>z.getTime())y=z,u(b.callback,(f||[]).concat(k?k():[]))};b.activityInterval=window.setInterval(E,b.configHeartBeatTimer)}function xd(b){var f=b.minimumVisitLength,k=b.heartbeatDelay;b=b.callback;if(id(f)&&id(k))return{configMinimumVisitLength:1E3*f,configHeartBeatTimer:1E3*
k,callback:b};ma.error("Activity tracking minimumVisitLength & heartbeatDelay must be integers")}function yd(b){var f=b.context,k=b.minXOffset,u=b.minYOffset,y=b.maxXOffset,E=b.maxYOffset;b=document.title;b!==Ka&&(Ka=b,gb=void 0);b=hb;var z=b.track,L=G(ib||Ia),D=$b(gb||Ka),Q=G(Pb||rb);k=Math.round(k);y=Math.round(y);u=Math.round(u);E=Math.round(E);var Y=Bb();Y.add("e","pp");Y.add("url",L);Y.add("page",D);Y.add("refr",Q);k&&!isNaN(Number(k))&&Y.add("pp_mix",k.toString());y&&!isNaN(Number(y))&&Y.add("pp_max",
y.toString());u&&!isNaN(Number(u))&&Y.add("pp_miy",u.toString());E&&!isNaN(Number(E))&&Y.add("pp_may",E.toString());z.call(b,Y,f)}function zd(b){if(n.trackerConfigUrl)Qb(n.trackerConfigUrl),lb=window.setInterval(Qb,6E4*b,n.trackerConfigUrl);else{var f=x.split("js-")[1];f="https://drt1fhpy4haqm.cloudfront.net/js/"+n.convivaCustomerKey+"/"+f+"/remote_config.json";Qb(f);lb=window.setInterval(Qb,6E4*b,f)}}var lc,mc,nc,oc,pc,qc,rc,sc,tc,uc,vc,wc,xc,yc,zc,Ac,Bc,Cc,Dc,Ec,Fc,Gc,Hc,Ic,Jc,Kc,Lc,Mc,Nc,fa={cacheRefreshInterval:30,
base64:!0,linkClickTracking:!0,buttonClickTracking:!0,customEvent:!0,exceptionAutotracking:!0,enablePeriodicHeartbeat:!0,periodicHeartbeatInterval:40,customEventTrackingConfiguration:{},convivaVideoEventTrackingConfiguration:{},ajaxTrackingConfiguration:{blocklist:["*"]},networkRequestTrackingConfiguration:{blocklist:["*"]}},N={},lb=null;if(window.localStorage){var Ad=localStorage.getItem("ConvivaRemoteConfig")?localStorage.getItem("ConvivaRemoteConfig"):JSON.stringify(N);var Oc=localStorage.getItem("ConvivaEndpoint")?
localStorage.getItem("ConvivaEndpoint"):"https://appgw.conviva.com"}else Oc="https://appgw.conviva.com",Ad=JSON.stringify(N);m=n.gatewayUrl?n.gatewayUrl:Oc?Oc:"https://appgw.conviva.com";t||(t="CAT");var R=JSON.parse(Ad);N.base64="undefined"!=typeof R.base64?R.base64:fa.base64;N.cacheRefreshInterval="undefined"!=typeof R.cacheRefreshInterval?R.cacheRefreshInterval:fa.cacheRefreshInterval;N.linkClickTracking="undefined"!=typeof R.linkClickTracking?R.linkClickTracking:fa.linkClickTracking;N.buttonClickTracking=
"undefined"!=typeof R.buttonClickTracking?R.buttonClickTracking:fa.buttonClickTracking;N.exceptionAutotracking="undefined"!=typeof R.exceptionAutotracking?R.exceptionAutotracking:fa.exceptionAutotracking;N.enablePeriodicHeartbeat="undefined"!=typeof R.enablePeriodicHeartbeat?R.enablePeriodicHeartbeat:fa.enablePeriodicHeartbeat;N.periodicHeartbeatInterval="undefined"!=typeof R.periodicHeartbeatInterval?R.periodicHeartbeatInterval:fa.periodicHeartbeatInterval;N.customEventTrackingConfiguration="undefined"!=
typeof R.customEventTrackingConfiguration?R.customEventTrackingConfiguration:X({},fa.customEventTrackingConfiguration);N.convivaVideoEventTrackingConfiguration="undefined"!=typeof R.convivaVideoEventTrackingConfiguration?R.convivaVideoEventTrackingConfiguration:X({},fa.convivaVideoEventTrackingConfiguration);N.ajaxTrackingConfiguration="undefined"!=typeof R.ajaxTrackingConfiguration?R.ajaxTrackingConfiguration:X({},fa.ajaxTrackingConfiguration);N.networkRequestTrackingConfiguration="undefined"!=typeof R.networkRequestTrackingConfiguration?
R.networkRequestTrackingConfiguration:X({},fa.networkRequestTrackingConfiguration);"undefined"!=typeof R.metaTagsTrackingConfiguration&&(N.metaTagsTrackingConfiguration=R.metaTagsTrackingConfiguration);try{var zb=XMLHttpRequest,Pc=null===(lc=null===window||void 0===window?void 0:window.fetch)||void 0===lc?void 0:lc.bind(window);if(zb){var me=function(b){var f={};b.trim().split(/[\r\n]+/).forEach(function(k){k=k.split(":");var u=k[1];f[k[0].trim()]=null===u||void 0===u?void 0:u.trim()});return f},
Rb=function(b,f,k){try{var u={status:null===b||void 0===b?void 0:b.status,statusText:(""!==(null===b||void 0===b?void 0:b.statusText)?null===b||void 0===b?void 0:b.statusText:void 0)||("load"!=k?k:void 0),responseTimestamp:null===Date||void 0===Date?void 0:Date.now(),responseTime:(null===performance||void 0===performance?void 0:performance.now())||(null===Date||void 0===Date?void 0:Date.now())};k=void 0;try{k=me(b.getAllResponseHeaders()),u.headers=k}catch(y){}try{u.body=null===b||void 0===b?void 0:
b.response}catch(y){}r.trackNetworkRequest({requestDetails:f,responseDetails:u})}catch(y){console.warn("Conviva App Tracker:: Unable to track network request error while handleResponse ".concat(y))}},Bd=function(){var b=new zb;try{var f,k,u={},y,E=b.setRequestHeader;b.setRequestHeader=function(D,Q){u[D]=Q;E.call(this,D,Q)};var z=b.open;b.open=function(){for(var D=[],Q=0;Q<arguments.length;Q++)D[Q]=arguments[Q];f=D[0];k=D[1];try{/^(?:[a-z]+:)?\/\//i.test(k)||(k=0===k.indexOf("/")?window.location.origin+
k:window.location.origin+"/"+k)}catch(Y){}z.call(b,D[0],D[1],!0)};var L=b.send;b.send=function(D){try{L.call(b,D),y={method:f,url:k,headers:u,body:D,requestTimestamp:null===Date||void 0===Date?void 0:Date.now(),requestTime:(null===performance||void 0===performance?void 0:performance.now())||(null===Date||void 0===Date?void 0:Date.now())}}catch(Q){console.warn("Conviva App Tracker:: Unable to track network request while send ".concat(Q))}};b.addEventListener("load",function(){return Rb(b,y,"load")});
b.addEventListener("error",function(){return Rb(b,y,"error")});b.addEventListener("abort",function(){return Rb(b,y,"abort")});b.addEventListener("timeout",function(){return Rb(b,y,"timeout")})}catch(D){console.warn("Conviva App Tracker:: Unable to track network request while interceptRequest ".concat(D))}return b},Sb;for(Sb in zb)zb.hasOwnProperty(Sb)&&(Bd[Sb]=zb[Sb]);window.XMLHttpRequest=Bd}if(Pc){var Cd=function(b){var f={};b.forEach(function(k,u){f[u]=k});return f};window.fetch=function(b,f){if(b instanceof
Request){b=b.clone();var k=Pc(b)}else k=Pc(b,f),b=(new Request(b,f)).clone();try{var u=void 0;try{u=Cd(b.headers)}catch(z){}var y=void 0;try{y=null===f||void 0===f?void 0:f.body}catch(z){}var E={method:b.method,url:b.url,headers:u,body:y,requestTimestamp:null===Date||void 0===Date?void 0:Date.now(),requestTime:(null===performance||void 0===performance?void 0:performance.now())||(null===Date||void 0===Date?void 0:Date.now())};k.then(function(z){try{var L=Cd(z.headers)}catch(Q){}var D={status:z.status,
statusText:""!==(null===z||void 0===z?void 0:z.statusText)?null===z||void 0===z?void 0:z.statusText:void 0,headers:L,size:0,responseTimestamp:null===Date||void 0===Date?void 0:Date.now(),responseTime:(null===performance||void 0===performance?void 0:performance.now())||(null===Date||void 0===Date?void 0:Date.now())};z.clone().json().then(function(Q){D.body=Q;r.trackNetworkRequest({requestDetails:E,responseDetails:D})})["catch"](function(){r.trackNetworkRequest({requestDetails:E,responseDetails:D})})})["catch"](function(z){z=
{statusText:z.toString(),responseTimestamp:null===Date||void 0===Date?void 0:Date.now(),responseTime:(null===performance||void 0===performance?void 0:performance.now())||(null===Date||void 0===Date?void 0:Date.now())};r.trackNetworkRequest({requestDetails:E,responseDetails:z})})}catch(z){console.warn("Conviva App Tracker:: Unable to track network request while fetch interceptRequest ".concat(z))}return k}}}catch(b){console.warn("Conviva App Tracker:: Unable to track network request ".concat(b))}var ne=
n.convivaCustomerKey;if(window.XMLHttpRequest){var mb=new XMLHttpRequest;mb.onreadystatechange=function(){try{if(4==mb.readyState)if(200==mb.status){var b=JSON.parse(mb.response);b.cacheRefreshInterval||(b.cacheRefreshInterval=fa.cacheRefreshInterval);N.cacheRefreshInterval!=b.cacheRefreshInterval&&(N.cacheRefreshInterval=b.cacheRefreshInterval,"number"===typeof lb&&window.clearInterval(lb),zd(b.cacheRefreshInterval));l(b,fa)}else try{var f=new XMLHttpRequest;f.onreadystatechange=function(){try{if(4==
f.readyState)if(200==f.status){var k=JSON.parse(f.response);l(k,fa)}else try{var u=new XMLHttpRequest;u.onreadystatechange=function(){try{if(4==u.readyState&&200==u.status){var y=JSON.parse(u.response);l(y,fa)}}catch(E){console.warn("Conviva App Tracker:: Error in fetching remote-config ".concat(E))}};u.open("GET","https://drt1fhpy4haqm.cloudfront.net/js/remote_config.json",!0);u.send()}catch(y){}}catch(y){console.warn("Conviva App Tracker:: Error in fetching remote-config ".concat(y))}};f.open("GET",
"https://drt1fhpy4haqm.cloudfront.net/js/"+ne+"/remote_config.json",!0);f.send()}catch(k){}}catch(k){console.warn("Conviva App Tracker:: Error in fetching remote-config ".concat(k))}};var Qb=function(b){try{mb.open("GET",b,!0),mb.send()}catch(f){}};"number"===typeof lb&&window.clearInterval(lb);zd(N.cacheRefreshInterval)}n.eventMethod=null!==(mc=n.eventMethod)&&void 0!==mc?mc:"post";var rd=function(b){var f;return null!==(f=b.stateStorageStrategy)&&void 0!==f?f:"cookieAndLocalStorage"},sd=function(b){var f,
k;return"boolean"===typeof b.anonymousTracking?!1:null!==(k=!0===(null===(f=b.anonymousTracking)||void 0===f?void 0:f.withSessionTracking))&&void 0!==k?k:!1},td=function(b){var f,k;return"boolean"===typeof b.anonymousTracking?!1:null!==(k=!0===(null===(f=b.anonymousTracking)||void 0===f?void 0:f.withServerAnonymisation))&&void 0!==k?k:!1};v.push(function(){return{beforeTrack:function(b){var f=ka("ses"),k=da();Qc=Rc?!!qa(Rc):!1;Dd||Qc?pa():("0"===k[0]?(Oa=f||"none"==V?k[6]:qb(k),ua=k[3]):(new Date).getTime()-
Sc>1E3*pd&&(ua++,Oa=qb(k,ua)),dc(k),-1===k[10]&&(f=b.build(),k[8]=f.eid,f=f.dtm||f.ttm,k[9]=f?parseInt(f):void 0),k[10]+=1,b.add("uid",fb?null:Pa),M(),b.add("refr",G(Pb||rb)),document&&(Ka=document.title,f=$b(gb||Ka),b.add("page",f)),b.add("url",G(ib||Ia)),!oe||tb||fb||(f=k[9],f={userId:k[1],sessionId:k[6],eventIndex:k[10],sessionIndex:k[3],previousSessionId:k[7]||null,storageMechanism:"localStorage"==V?"LOCAL_STORAGE":"COOKIE_1",firstEventId:k[8]||null,firstEventTimestamp:f?(new Date(f)).toISOString():
null},b.addContextEntity({schema:"iglu:com.snowplowanalytics.snowplow/client_session/jsonschema/1-0-2",data:f})),"none"!=V&&(Ga(k),na()),Sc=(new Date).getTime())}}}());(null!==(oc=null===(nc=null===n||void 0===n?void 0:n.contexts)||void 0===nc?void 0:nc.webPage)&&void 0!==oc?oc:1)&&v.push(F());v.push(function(){return{contexts:function(){var b=ub,f=Ob.toString(),k=pe;try{var u=window.localStorage.getItem(hc+"."+ic),y=JSON.parse(u||"{}");"{}"!==y&&"undefined"!==typeof y&&"undefined"!==typeof y[vb]&&
(Ja=y[vb]);2147483647<=Ja?Ja=0:Ja++;A();var E=Ja}catch(z){console.warn(z),E=void 0}b={schema:"iglu:com.conviva/clid_schema/jsonschema/1-0-2",data:{clid:b,iid:f,ck:k,eventIndex:E}};f={eventIndex:qe++};null!=Tc&&(f.previousEventTimestamp=Tc);Tc=(new Date).toISOString();return[b,{schema:"iglu:com.conviva/event_info/jsonschema/1-0-1",data:f}]}}}());v.push(function(){return{contexts:function(){return[{schema:"iglu:com.conviva/custom_tags/jsonschema/1-0-0",data:{data:X(X({},jc),kc)}}]}}}());v.push(function(){return{contexts:function(){return[{schema:"iglu:com.snowplowanalytics.mobile/application/jsonschema/1-0-0",
data:{build:Ed,version:Ed}}]}}}());v.push.apply(v,null!==(pc=n.plugins)&&void 0!==pc?pc:[]);var hb=ae({base64:N.base64,corePlugins:v,callback:function(b){Dd||Qc||za.enqueueRequest(b.build(),Uc)},linkClickTracking:N.linkClickTracking,buttonClickTracking:N.buttonClickTracking,customEvent:!0,exceptionAutotracking:N.exceptionAutotracking,enablePeriodicHeartbeat:N.enablePeriodicHeartbeat,periodicHeartbeatInterval:N.periodicHeartbeatInterval,customEventTrackingConfiguration:N.customEventTrackingConfiguration,
convivaVideoEventTrackingConfiguration:N.convivaVideoEventTrackingConfiguration,ajaxTrackingConfiguration:N.ajaxTrackingConfiguration,networkRequestTrackingConfiguration:N.networkRequestTrackingConfiguration,metaTagsTrackingConfiguration:N.metaTagsTrackingConfiguration}),Ma=ld(window.location.hostname,window.location.href,bc()),md=jd(Ma[0]),Ia=Ma[1],rb=Ma[2],Pb,re=null!==(qc=n.platform)&&void 0!==qc?qc:"web",Uc=db(m),se=null!==(rc=n.postPath)&&void 0!==rc?rc:"/"+n.convivaCustomerKey+"/ctp",te=null!==
(sc=n.appId)&&void 0!==sc?sc:"",pe=null!==(tc=n.convivaCustomerKey)&&void 0!==tc?tc:"",Ed=null!==(uc=n.appVersion)&&void 0!==uc?uc:"",ib,jc={},kc={},Ka=document.title,gb,le=null!==(vc=n.resetActivityTrackingOnPageView)&&void 0!==vc?vc:!0,nd,od,eb=null!==(wc=n.cookieName)&&void 0!==wc?wc:"_sp_",sb=null!==(xc=n.cookieDomain)&&void 0!==xc?xc:void 0,ec="/",Mb=null!==(yc=n.cookieSameSite)&&void 0!==yc?yc:"None",Nb=null!==(zc=n.cookieSecure)&&void 0!==zc?zc:!0,Fd=navigator.doNotTrack||navigator.msDoNotTrack||
window.doNotTrack,Dd="undefined"!==typeof n.respectDoNotTrack?n.respectDoNotTrack&&("yes"===Fd||"1"===Fd):!1,Rc,qd=null!==(Ac=n.cookieLifetime)&&void 0!==Ac?Ac:63072E3,pd=null!==(Bc=n.sessionCookieTimeout)&&void 0!==Bc?Bc:1800,tb=sd(n),gc=td(n),fb=!!n.anonymousTracking,V=rd(n),hc="Conviva",ic="sdkConfig",vb="eventIndex",ub,Ob,Ja=-1,qe=0,fc,Sc=(new Date).getTime(),Ib,Jb,Kb,Lb,Na,Hb,Oa,ua=1,Pa,za=he(q,B,"localStorage"==V||"cookieAndLocalStorage"==V,n.eventMethod,se,null!==(Cc=n.bufferSize)&&void 0!==
Cc?Cc:1,null!==(Dc=n.maxPostBytes)&&void 0!==Dc?Dc:4E4,null!==(Ec=n.maxGetBytes)&&void 0!==Ec?Ec:0,null!==(Fc=n.useStm)&&void 0!==Fc?Fc:!0,null!==(Gc=n.maxLocalStorageQueueSize)&&void 0!==Gc?Gc:1E3,null!==(Hc=n.connectionTimeout)&&void 0!==Hc?Hc:5E3,gc,null!==(Ic=n.customHeaders)&&void 0!==Ic?Ic:{},null!==(Jc=n.withCredentials)&&void 0!==Jc?Jc:!0,null!==(Kc=n.retryStatusCodes)&&void 0!==Kc?Kc:[],(null!==(Lc=n.dontRetryStatusCodes)&&void 0!==Lc?Lc:[]).concat([400,401,403,410,422])),ud=!1,Tc,wd=!1,
la={enabled:!0,installed:!1,configurations:{pagePing:{configMinimumVisitLength:5E3,configHeartBeatTimer:4E4,callback:yd}}},oe=null!==(Nc=null===(Mc=n.contexts)||void 0===Mc?void 0:Mc.session)&&void 0!==Nc?Nc:!1,Qc;n.hasOwnProperty("discoverRootDomain")&&n.discoverRootDomain&&(sb=de(Mb,Nb));hb.setTrackerVersion(x);hb.setAppId(te);hb.setPlatform(re);xa();sa();za.setCustomHeaders({"x-client-id":""+ub});n.crossDomainLinker&&P(n.crossDomainLinker);var vd=function(b){try{return"object"===typeof JSON.parse(b)}catch(f){return!1}};
return X(X({},{getDomainSessionIndex:function(){return ua},getPageViewId:function(){return H()},newSession:function(){var b=da();"0"===b[0]?(Oa="none"!=V?qb(b):b[6],ua=b[3],na()):(ua++,Oa=qb(b,ua));dc(b);"none"!=V&&(Ga(b),na());Sc=(new Date).getTime()},getCookieName:function(b){return eb+b+"."+Na},getUserId:function(){return Pa},getDomainUserId:function(){return da()[1]},getDomainUserInfo:function(){return da()},setReferrerUrl:function(b){Pb=b},setCustomUrl:function(b){M();var f=Ia,k;ba(b)?ib=b:"/"===
b.slice(0,1)?ib=ba(f)+"://"+ac(f)+b:(f=G(f),0<=(k=f.indexOf("?"))&&(f=f.slice(0,k)),(k=f.lastIndexOf("/"))!==f.length-1&&(f=f.slice(0,k+1)),ib=f+b)},setDocumentTitle:function(b){Ka=document.title;gb=b},discardHashTag:function(b){nd=b},discardBrace:function(b){od=b},setCookiePath:function(b){ec=b;xa()},setVisitorCookieTimeout:function(b){qd=b},crossDomainLinker:function(b){P(b)},enableActivityTracking:function(b){la.configurations.pagePing||(la.enabled=!0,la.configurations.pagePing=xd(X(X({},b),{callback:yd})))},
enableActivityTrackingCallback:function(b){la.configurations.callback||(la.enabled=!0,la.configurations.callback=xd(b))},updatePageActivity:function(){ra()},setOptOutCookie:function(b){Rc=b},setUserId:function(b){Pa=b},setUserIdFromLocation:function(b){M();Pa=pb(b,Ia)},setUserIdFromReferrer:function(b){M();Pa=pb(b,rb)},setUserIdFromCookie:function(b){Pa=qa(b)},setCollectorUrl:function(b){Uc=db(b);za.setCollectorUrl(Uc)},setBufferSize:function(b){za.setBufferSize(b)},flushBuffer:function(b){void 0===
b&&(b={});za.executeQueue();b.newBufferSize&&za.setBufferSize(b.newBufferSize)},trackPageView:function(b){void 0===b&&(b={});ya();ca(b)},trackVideoEvent:function(b){void 0===b&&(b={});try{var f=this.core.getConfig();""!=b.name&&void 0!=b.name||console.warn("Conviva App Tracker:: Video event could not be tracked due to missing name property!!");if(void 0!=f.convivaVideoEventTrackingConfiguration)if(void 0!=f.convivaVideoEventTrackingConfiguration.blocklist&&0<f.convivaVideoEventTrackingConfiguration.blocklist.length){var k=
f.convivaVideoEventTrackingConfiguration.blocklist;-1==k.indexOf("*")&&-1==k.indexOf(""+b.name)&&this.core.track(Zb({name:b.name,sid:b.sid,iid:b.iid,clid:b.clid,st:b.st,sst:b.sst,an:b.an,cl:b.cl,lv:b.lv,pn:b.pn,vid:b.vid,fw:b.fw,fwv:b.fwv,mn:b.mn,mv:b.mv,url:b.url,tags:b.tags,cen:b.cen,ced:b.ced,oldsc:b.old,newsc:b["new"],err:b.err,br:b.br,ft:b.ft}),b.context,b.timestamp)}else this.core.track(Zb({name:b.name,sid:b.sid,iid:b.iid,clid:b.clid,st:b.st,sst:b.sst,an:b.an,cl:b.cl,lv:b.lv,pn:b.pn,vid:b.vid,
fw:b.fw,fwv:b.fwv,mn:b.mn,mv:b.mv,url:b.url,tags:b.tags,cen:b.cen,ced:b.ced,oldsc:b.old,newsc:b["new"],err:b.err,br:b.br,ft:b.ft}),b.context,b.timestamp);else this.core.track(Zb({name:b.name,sid:b.sid,iid:b.iid,clid:b.clid,st:b.st,sst:b.sst,an:b.an,cl:b.cl,lv:b.lv,pn:b.pn,vid:b.vid,fw:b.fw,fwv:b.fwv,mn:b.mn,mv:b.mv,url:b.url,tags:b.tags,cen:b.cen,ced:b.ced,oldsc:b.old,newsc:b["new"],err:b.err,br:b.br,ft:b.ft}),b.context,b.timestamp)}catch(u){console.warn("Conviva App Tracker:: Video event could not be tracked due to an exception!!",
u)}},trackAjaxEvent:function(b){void 0===b&&(b={});try{if("xmlhttprequest"===b.initiatorType||"fetch"===b.initiatorType){var f=this.core.getConfig();if(""==b.name||void 0==b.name)console.warn("Conviva App Tracker:: Ajax request could not be tracked due to missing URL property!!");else if(void 0!=f.ajaxTrackingConfiguration&&void 0!=f.ajaxTrackingConfiguration.blocklist&&0<f.ajaxTrackingConfiguration.blocklist.length){var k=f.ajaxTrackingConfiguration.blocklist;if(-1==k.indexOf("*")){f=!1;for(var u=
0;u<k.length;u++)""!==k[u]&&-1!==b.name.toLowerCase().indexOf(k[u].toLowerCase())&&(f=!0);if(!f){var y=this.core,E=y.track;var z=ob({event:{schema:"iglu:com.conviva/network_request/jsonschema/1-0-2",data:Eb({targetUrl:b.name,responseStatusCode:b.responseStatus,duration:b.duration})}});E.call(y,z,b.context,b.timestamp)}}}}}catch(L){console.warn("Conviva App Tracker:: Ajax request could not be tracked due to an exception!!",L)}},trackNetworkRequest:function(b){var f,k,u,y,E,z,L,D,Q,Y,Qa,Ra,Sa,Ta,Ua,
Va,Wa,Xa,Ya,Za,$a,ab;void 0===b&&(b={});try{var wb=this.core.getConfig(),bb=b.responseDetails.responseTime-b.requestDetails.requestTime;try{bb=parseFloat(bb.toFixed(3))}catch(W){console.warn("Conviva App Tracker:: exception while converting duration to 3 decimal",W)}var J=function(W){try{var Ba=void 0;"undefined"!=typeof W&&null!==W&&(Ba=W["content-type"]||W["Content-Type"]||W["Content-type"]);return Ba}catch(ue){}},ia=function(W){try{var Ba=void 0;"undefined"!=typeof W&&null!==W&&(Ba=W["content-length"]||
W["Content-Length"]||W["Content-length"]);return"undefined"==typeof Ba||null===Ba||isNaN(Ba)?Ba:Number(Ba)}catch(ue){}},yb=ia(null===(k=null===b||void 0===b?void 0:b.requestDetails)||void 0===k?void 0:k.headers),jb=ia(null===(u=null===b||void 0===b?void 0:b.responseDetails)||void 0===u?void 0:u.headers),va=J(null===(y=null===b||void 0===b?void 0:b.requestDetails)||void 0===y?void 0:y.headers),wa=J(null===(E=null===b||void 0===b?void 0:b.responseDetails)||void 0===E?void 0:E.headers);try{var Aa=(f=
{targetUrl:null===(z=null===b||void 0===b?void 0:b.requestDetails)||void 0===z?void 0:z.url,method:null===(L=null===b||void 0===b?void 0:b.requestDetails)||void 0===L?void 0:L.method,responseStatusCode:null===(D=null===b||void 0===b?void 0:b.responseDetails)||void 0===D?void 0:D.status,responseStatusText:null===(Q=null===b||void 0===b?void 0:b.responseDetails)||void 0===Q?void 0:Q.statusText},f[ha.request_headers]=null===(Y=null===b||void 0===b?void 0:b.requestDetails)||void 0===Y?void 0:Y.headers,
f[ha.response_headers]=null===(Qa=null===b||void 0===b?void 0:b.responseDetails)||void 0===Qa?void 0:Qa.headers,f.requestSize=yb,f.responseSize=jb,f.duration=bb,f.requestTimestamp=null===(Ra=null===b||void 0===b?void 0:b.requestDetails)||void 0===Ra?void 0:Ra.requestTimestamp,f.responseTimestamp=null===(Sa=null===b||void 0===b?void 0:b.responseDetails)||void 0===Sa?void 0:Sa.responseTimestamp,f.contentType=va,f);if("undefined"!==typeof va&&(va.toLowerCase().includes("text/plain")||va.toLowerCase().includes("json")||
va.toLowerCase().includes("text/javascript")||va.toLowerCase().includes("application/javascript"))||"undefined"===typeof va)if("string"===typeof(null===(Ta=null===b||void 0===b?void 0:b.requestDetails)||void 0===Ta?void 0:Ta.body))try{1E4>=(null===(Ua=null===b||void 0===b?void 0:b.requestDetails)||void 0===Ua?void 0:Ua.body.length)&&(Aa[ha.request_body]=JSON.parse(null===(Va=null===b||void 0===b?void 0:b.requestDetails)||void 0===Va?void 0:Va.body))}catch(W){}else"object"===typeof(null===(Wa=null===
b||void 0===b?void 0:b.requestDetails)||void 0===Wa?void 0:Wa.body)&&(Aa[ha.request_body]=null===(Xa=null===b||void 0===b?void 0:b.requestDetails)||void 0===Xa?void 0:Xa.body);if("undefined"!==typeof wa&&(wa.toLowerCase().includes("text/plain")||wa.toLowerCase().includes("json")||wa.toLowerCase().includes("text/javascript")||wa.toLowerCase().includes("application/javascript"))&&"undefined"!==typeof jb&&1E4>=jb)if("string"===typeof(null===(Ya=null===b||void 0===b?void 0:b.responseDetails)||void 0===
Ya?void 0:Ya.body))try{Aa[ha.response_body]=JSON.parse(null===(Za=null===b||void 0===b?void 0:b.responseDetails)||void 0===Za?void 0:Za.body)}catch(W){}else"object"===typeof(null===($a=null===b||void 0===b?void 0:b.responseDetails)||void 0===$a?void 0:$a.body)&&(Aa[ha.response_body]=null===(ab=null===b||void 0===b?void 0:b.responseDetails)||void 0===ab?void 0:ab.body);var kb=wb.networkRequestTrackingConfiguration;if(kb&&kb.enabled){var Tb=kb.blocklist;if(-1==Tb.indexOf("*")){f=!1;for(k=0;k<Tb.length;k++)""!==
Tb[k]&&-1!==Aa.targetUrl.toLowerCase().indexOf(Tb[k].toLowerCase())&&(f=!0);f||this.core.track(ce(ee(Aa,kb.collectattr)),b.context,b.timestamp)}}}catch(W){console.warn("Conviva App Tracker:: Network request could not be tracked due to an exception!!",W)}}catch(W){console.warn("Conviva App Tracker:: Network request could not be tracked due to an exception!!",W)}},setCustomTags:function(b){void 0===b&&(b={});ta(b)},setMetaCustomTags:function(b){void 0===b&&(b={});Ha(b)},unsetCustomTags:function(b){void 0===
b&&(b={});cc(b)},preservePageViewId:function(){ud=!0},disableAnonymousTracking:function(b){n.anonymousTracking=!1;ja(b);sa();za.executeQueue()},enableAnonymousTracking:function(b){var f;n.anonymousTracking=null!==(f=b&&(null===b||void 0===b?void 0:b.options))&&void 0!==f?f:!0;ja(b);tb||w()},clearUserData:pa}),{id:q,namespace:t,core:hb,sharedState:B})}(a,c,d,e,h,g);var r=X(X({},a),{addPlugin:function(q){var t,x;r.core.addPlugin(q);null===(x=(t=q.plugin).activateBrowserPlugin)||void 0===x?void 0:x.call(t,
r)}});v.forEach(function(q){var t;null===(t=q.activateBrowserPlugin)||void 0===t?void 0:t.call(q,r)});return r}function I(a,c){try{var d=null!==a&&void 0!==a?a:Object.keys(Ab);a=Ab;for(var e=[],h=0;h<d.length;h++){var g=d[h];a.hasOwnProperty(g)?e.push(a[g]):ma.warn(g+" not configured")}e.forEach(c)}catch(l){ma.error("Function failed",l)}}function Gd(a,c,d,e,h,g){return Ab.hasOwnProperty(a)?null:(Ab[a]=je(a,c,d,e,h,g),Ab[a])}function ve(){function a(){try{"hidden"==h.visibilityState&&e.bufferFlushers.forEach(function(l){l(!1)})}catch(l){console.warn("Conviva App Tracker:: Error in visibilityChangeHandler of constructor ".concat(l))}}
function c(){var l;if(!e.hasLoaded)for(e.hasLoaded=!0,l=0;l<e.registeredOnLoadHandlers.length;l++)e.registeredOnLoadHandlers[l]();return!0}function d(){h.addEventListener?h.addEventListener("DOMContentLoaded",function p(){h.removeEventListener("DOMContentLoaded",p,!1);c()}):h.attachEvent&&h.attachEvent("onreadystatechange",function v(){"complete"===h.readyState&&(h.detachEvent("onreadystatechange",v),c())});Fa(g,"load",c,!1)}var e=new we,h=document,g=window;h.visibilityState&&Fa(h,"visibilitychange",
a,!1);Fa(g,"beforeunload",function(){try{e.bufferFlushers.forEach(function(l){l(!1)})}catch(l){console.warn("Conviva App Tracker:: Error in flushBuffers of constructor ".concat(l))}},!1);"loading"===document.readyState?d():c();return e}var X=function(){X=Object.assign||function(a){for(var c,d=1,e=arguments.length;d<e;d++){c=arguments[d];for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&(a[h]=c[h])}return a};return X.apply(this,arguments)},La={},Hd="undefined"!=typeof crypto&&crypto.getRandomValues&&
crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(Hd){var Id=new Uint8Array(16);La=function(){Hd(Id);return Id}}else{var Jd=Array(16);La=function(){for(var a=0,c;16>a;a++)0===(a&3)&&(c=4294967296*Math.random()),Jd[a]=c>>>((a&3)<<3)&255;return Jd}}for(var aa=[],Ub=0;256>Ub;++Ub)aa[Ub]=(Ub+256).toString(16).substr(1);var Kd=function(a,c){c=c||0;return[aa[a[c++]],aa[a[c++]],aa[a[c++]],aa[a[c++]],
"-",aa[a[c++]],aa[a[c++]],"-",aa[a[c++]],aa[a[c++]],"-",aa[a[c++]],aa[a[c++]],"-",aa[a[c++]],aa[a[c++]],aa[a[c++]],aa[a[c++]],aa[a[c++]],aa[a[c++]]].join("")},xe=La,Ld,Vc,Wc=0,Xc=0,ye=La;La=function(a,c,d){d=c&&d||0;"string"==typeof a&&(c="binary"===a?Array(16):null,a=null);a=a||{};a=a.random||(a.rng||ye)();a[6]=a[6]&15|64;a[8]=a[8]&63|128;if(c)for(var e=0;16>e;++e)c[d+e]=a[e];return c||Kd(a)};La.v1=function(a,c,d){d=c&&d||0;var e=c||[];a=a||{};var h=a.node||Ld,g=void 0!==a.clockseq?a.clockseq:Vc;
if(null==h||null==g){var l=xe();null==h&&(h=Ld=[l[0]|1,l[1],l[2],l[3],l[4],l[5]]);null==g&&(g=Vc=(l[6]<<8|l[7])&16383)}l=void 0!==a.msecs?a.msecs:(new Date).getTime();var p=void 0!==a.nsecs?a.nsecs:Xc+1,v=l-Wc+(p-Xc)/1E4;0>v&&void 0===a.clockseq&&(g=g+1&16383);(0>v||l>Wc)&&void 0===a.nsecs&&(p=0);if(1E4<=p)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");Wc=l;Xc=p;Vc=g;l+=122192928E5;a=(1E4*(l&268435455)+p)%4294967296;e[d++]=a>>>24&255;e[d++]=a>>>16&255;e[d++]=a>>>8&255;e[d++]=a&255;
a=l/4294967296*1E4&268435455;e[d++]=a>>>8&255;e[d++]=a&255;e[d++]=a>>>24&15|16;e[d++]=a>>>16&255;e[d++]=g>>>8|128;e[d++]=g&255;for(g=0;6>g;++g)e[d+g]=h[g];return c?c:Kd(e)};var Ea=La.v4=La,Da="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ca;(function(a){a[a.none=0]="none";a[a.error=1]="error";a[a.warn=2]="warn";a[a.debug=3]="debug";a[a.info=4]="info"})(Ca||(Ca={}));var ma=function(a){void 0===a&&(a=Ca.warn);return{setLogLevel:function(c){a=Ca[c]?c:Ca.warn},warn:function(c,d){for(var e=
[],h=2;h<arguments.length;h++)e[h-2]=arguments[h];a>=Ca.warn&&"undefined"!==typeof console&&(h="Snowplow: "+c,d?console.warn.apply(console,U([h+"\n",d],e,!1)):console.warn.apply(console,U([h],e,!1)))},error:function(c,d){for(var e=[],h=2;h<arguments.length;h++)e[h-2]=arguments[h];a>=Ca.error&&"undefined"!==typeof console&&(h="Snowplow: "+c+"\n",d?console.error.apply(console,U([h+"\n",d],e,!1)):console.error.apply(console,U([h],e,!1)))},debug:function(c){for(var d=[],e=1;e<arguments.length;e++)d[e-
1]=arguments[e];a>=Ca.debug&&"undefined"!==typeof console&&console.debug.apply(console,U(["Snowplow: "+c],d,!1))},info:function(c){for(var d=[],e=1;e<arguments.length;e++)d[e-1]=arguments[e];a>=Ca.info&&"undefined"!==typeof console&&console.info.apply(console,U(["Snowplow: "+c],d,!1))}}}(),Md;(function(a){a.response_body="rsb";a.request_body="rqb";a.response_headers="rsh";a.request_headers="rqh"})(Md||(Md={}));var Nd={},Od={};(function(){var a={rotl:function(c,d){return c<<d|c>>>32-d},rotr:function(c,
d){return c<<32-d|c>>>d},endian:function(c){if(c.constructor==Number)return a.rotl(c,8)&16711935|a.rotl(c,24)&4278255360;for(var d=0;d<c.length;d++)c[d]=a.endian(c[d]);return c},randomBytes:function(c){for(var d=[];0<c;c--)d.push(Math.floor(256*Math.random()));return d},bytesToWords:function(c){for(var d=[],e=0,h=0;e<c.length;e++,h+=8)d[h>>>5]|=c[e]<<24-h%32;return d},wordsToBytes:function(c){for(var d=[],e=0;e<32*c.length;e+=8)d.push(c[e>>>5]>>>24-e%32&255);return d},bytesToHex:function(c){for(var d=
[],e=0;e<c.length;e++)d.push((c[e]>>>4).toString(16)),d.push((c[e]&15).toString(16));return d.join("")},hexToBytes:function(c){for(var d=[],e=0;e<c.length;e+=2)d.push(parseInt(c.substr(e,2),16));return d},bytesToBase64:function(c){for(var d=[],e=0;e<c.length;e+=3)for(var h=c[e]<<16|c[e+1]<<8|c[e+2],g=0;4>g;g++)8*e+6*g<=8*c.length?d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(h>>>6*(3-g)&63)):d.push("=");return d.join("")},base64ToBytes:function(c){c=c.replace(/[^A-Z0-9+\/]/ig,
"");for(var d=[],e=0,h=0;e<c.length;h=++e%4)0!=h&&d.push(("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(c.charAt(e-1))&Math.pow(2,-2*h+8)-1)<<2*h|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(c.charAt(e))>>>6-2*h);return d}};Od=a})();var Yc={utf8:{stringToBytes:function(a){return Yc.bin.stringToBytes(unescape(encodeURIComponent(a)))},bytesToString:function(a){return decodeURIComponent(escape(Yc.bin.bytesToString(a)))}},bin:{stringToBytes:function(a){for(var c=
[],d=0;d<a.length;d++)c.push(a.charCodeAt(d)&255);return c},bytesToString:function(a){for(var c=[],d=0;d<a.length;d++)c.push(String.fromCharCode(a[d]));return c.join("")}}},Pd=Yc;(function(){var a=Od,c=Pd.utf8,d=Pd.bin,e=function(h,g){var l=a.wordsToBytes,p=h;p.constructor==String?p=c.stringToBytes(p):"undefined"!==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(p)?p=Array.prototype.slice.call(p,0):Array.isArray(p)||(p=p.toString());h=a.bytesToWords(p);var v=8*p.length;p=[];var r=
1732584193,q=-271733879,t=-1732584194,x=271733878,m=-1009589776;h[v>>5]|=128<<24-v%32;h[(v+64>>>9<<4)+15]=v;for(v=0;v<h.length;v+=16){for(var B=r,n=q,M=t,O=x,P=m,G=0;80>G;G++){if(16>G)p[G]=h[v+G];else{var ba=p[G-3]^p[G-8]^p[G-14]^p[G-16];p[G]=ba<<1|ba>>>31}ba=(r<<5|r>>>27)+m+(p[G]>>>0)+(20>G?(q&t|~q&x)+1518500249:40>G?(q^t^x)+1859775393:60>G?(q&t|q&x|t&x)-1894007588:(q^t^x)-899497514);m=x;x=t;t=q<<30|q>>>2;q=r;r=ba}r+=B;q+=n;t+=M;x+=O;m+=P}l=l.call(a,[r,q,t,x,m]);return g&&g.asBytes?l:g&&g.asString?
d.bytesToString(l):a.bytesToHex(l)};e._blocksize=16;e._digestsize=20;Nd=e})();var ke=Nd,ha;(function(a){a.response_body="rsb";a.request_body="rqb";a.response_headers="rsh";a.request_headers="rqh"})(ha||(ha={}));var xb;(function(a){a[a.APP=0]="APP";a[a.REMOTE=1]="REMOTE";a[a.MERGE=2]="MERGE"})(xb||(xb={}));var Ab={},we=function(){return function(){this.outQueues=[];this.bufferFlushers=[];this.hasLoaded=!1;this.registeredOnLoadHandlers=[]}}(),Vb="undefined"!==typeof window?ve():void 0;C.addGlobalContexts=
function(a,c){I(c,function(d){d.core.addGlobalContexts(a)})};C.addPlugin=function(a,c){I(c,function(d){d.addPlugin(a)})};C.clearGlobalContexts=function(a){I(a,function(c){c.core.clearGlobalContexts()})};C.clearUserData=function(a,c){I(c,function(d){d.clearUserData(a)})};C.convivaAppTracker=function(a){void 0===a&&(a={});try{if(Vb){var c=Gd("CAT","CAT","js-".concat("0.4.8"),"",Vb,a);document&&document.addEventListener&&document.addEventListener("convivaVideoEvent",function(d){d&&c&&c.trackVideoEvent(d)});
PerformanceObserver&&(new PerformanceObserver(function(d){d.getEntries().forEach(function(e){c&&c.trackAjaxEvent(e)})})).observe({type:"resource",buffered:!0});return c}}catch(d){console.warn("Conviva App Tracker:: Initialisation failed! "+d)}};C.crossDomainLinker=function(a,c){I(c,function(d){d.crossDomainLinker(a)})};C.disableAnonymousTracking=function(a,c){I(c,function(d){d.disableAnonymousTracking(a)})};C.discardBrace=function(a,c){I(c,function(d){d.discardBrace(a)})};C.discardHashTag=function(a,
c){I(c,function(d){d.discardHashTag(a)})};C.enableActivityTracking=function(a,c){I(c,function(d){d.enableActivityTracking(a)})};C.enableActivityTrackingCallback=function(a,c){I(c,function(d){d.enableActivityTrackingCallback(a)})};C.enableAnonymousTracking=function(a,c){I(c,function(d){d.enableAnonymousTracking(a)})};C.flushBuffer=function(a,c){I(c,function(d){d.flushBuffer(a)})};C.newSession=function(a){I(a,function(c){c.newSession()})};C.newTracker=function(a,c,d){void 0===d&&(d={});if(Vb)return Gd(a,
a,"js-".concat("0.4.8"),c,Vb,d)};C.preservePageViewId=function(a){I(a,function(c){c.preservePageViewId()})};C.removeGlobalContexts=function(a,c){I(c,function(d){d.core.removeGlobalContexts(a)})};C.setBufferSize=function(a,c){I(c,function(d){d.setBufferSize(a)})};C.setCollectorUrl=function(a,c){I(c,function(d){d.setCollectorUrl(a)})};C.setCookiePath=function(a,c){I(c,function(d){d.setCookiePath(a)})};C.setCustomTags=function(a,c){I(c,function(d){try{d.setCustomTags(a)}catch(e){console.warn("Conviva App Tracker:: Unable to set custom tags data!")}})};
C.setCustomUrl=function(a,c){I(c,function(d){d.setCustomUrl(a)})};C.setDocumentTitle=function(a,c){I(c,function(d){d.setDocumentTitle(a)})};C.setOptOutCookie=function(a,c){I(c,function(d){d.setOptOutCookie(a)})};C.setReferrerUrl=function(a,c){I(c,function(d){d.setReferrerUrl(a)})};C.setUserId=function(a,c){I(c,function(d){d.setUserId(a)})};C.setUserIdFromCookie=function(a,c){I(c,function(d){d.setUserIdFromCookie(a)})};C.setUserIdFromLocation=function(a,c){I(c,function(d){d.setUserIdFromLocation(a)})};
C.setUserIdFromReferrer=function(a,c){I(c,function(d){d.setUserIdFromReferrer(a)})};C.setVisitorCookieTimeout=function(a,c){I(c,function(d){d.setVisitorCookieTimeout(a)})};C.trackCustomEvent=function(a,c){I(c,function(d){try{var e=d.core.getConfig();""!=a.name&&void 0!=a.name||console.warn("Conviva App Tracker:: custom event name is mandatory for trackCustomEvent API!!");if(void 0!=e.customEventTrackingConfiguration){var h=a.data;try{"string"!==typeof a.data&&(h=JSON.stringify(a.data))}catch(l){}if(void 0!=
e.customEventTrackingConfiguration.blocklist&&0<e.customEventTrackingConfiguration.blocklist.length){var g=e.customEventTrackingConfiguration.blocklist;-1==g.indexOf("*")&&-1==g.indexOf(""+a.name)&&d.core.track(Yb({name:a.name,data:h}),a.context,a.timestamp)}else d.core.track(Yb({name:a.name,data:h}),a.context,a.timestamp)}else d.core.track(Yb({name:a.name,data:a.data}),a.context,a.timestamp)}catch(l){console.warn("Conviva App Tracker:: Unable to track custom event! "+l)}})};C.trackPageView=function(a,
c){I(c,function(d){d.trackPageView(a)})};C.trackSelfDescribingEvent=function(a,c){I(c,function(d){d.core.track(ob({event:a.event}),a.context,a.timestamp)})};C.trackStructEvent=function(a,c){I(c,function(d){d=d.core;var e=d.track,h=a.category,g=a.action,l=a.label,p=a.property,v=a.value,r=Bb();r.add("e","se");r.add("se_ca",h);r.add("se_ac",g);r.add("se_la",l);r.add("se_pr",p);r.add("se_va",null==v?void 0:v.toString());e.call(d,r,a.context,a.timestamp)})};C.unsetCustomTags=function(a,c){I(c,function(d){try{d.unsetCustomTags(a)}catch(e){console.warn("Conviva App Tracker:: Unable to set custom tags data!")}})};
C.updatePageActivity=function(a){I(a,function(c){c.updatePageActivity()})};C.version="0.4.8";Object.defineProperty(C,"__esModule",{value:!0})})
//# sourceMappingURL=index.umd.min.js.map
